---
title: "Informe-Inaccesibilidad sanitaria y salud"
author: "Lorena González, Alba Miguel, Noelia Pérez"
date: "27/10/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## **Introducción**

La accesibilidad a la asistencia sanitaria es fundamental para garantizar la equidad del sistema sanitario. Los pacientes deben de recibir una atención oportuna, rápida y adecuada a sus condiciones de salud.

La **inaccesibilidad** se define como aquello que no está accesible, es decir, sin acceso o trato.

A través de este trabajo analizaremos algunos de los aspectos que actualmente desencadenan situaciones de inaccesibilidad en las distintas comunidades autónomas de España. Entre otros, la inaccesibilidad por dificultades económicas o de transporte.

El informe consta de diferentes partes. En primer lugar, presentaremos los objetivos. Después desarrollaremos la metodología que vamos a utilizar para abordar cada uno de ellos, y por último, incidiremos en la importación y el análisis de los datos,así como las correspondientes conclusiones.

Adjuntamos el link del [repositorio](<https://github.com/albamiguel/Inaccesibilidad-sanitaria-y-efectos-en-salud>)

## **Objetivos**

*OBJETIVO GENERAL*: Comprobar la relación entre la inaccesibilidad a la sanidad y los efectos que puede provocar en la salud humana.

*OBEJTIVOS ESPECÍFICOS*:

-Inaccesibilidad por motivos económicos y comunidad autónoma

-Relación entre los casos de muerte y la inaccesibilidad (por comunidad autónoma)

-Inaccesibilidad y dificultades de transporte (por comunidad autónoma)

## **Metodología**

### **PROCEDENCIA DE LOS DATOS**:

Hemos extraído los datos del **Instituto Nacional de Estadística (INE)**. El INE es un organismo autónomo de carácter administrativo, con personalidad jurídica y patrimonio propio, adscrito al Ministerio de Asuntos Económicos y Transformación Digital a través de la Secretaría de Estado de Economía y Apoyo a la Empresa.Ver [aqui](https://www.ine.es/index.htm)

Está encargado de producir información estadística de la más alta calidad acerca de numerosos ámbitos como la economía, la sociedad y el medio ambiente, entre otros, para favorecer así la correcta toma de decisiones.

En este sitio web hemos encontrado una gran cantidad de información estadística de libre acceso (OA), en diversidad de formatos.

**Datos**: 

- [Inaccesibilidad por motivos económicos](https://www.ine.es/jaxi/Tabla.htm?path=/t15/p420/a2019/p02/l0/&file=05016.px&L=0)

- [Defunciones por comunidad autónoma](https://www.ine.es/jaxi/Datos.htm?tpx=21856)

- [Demora excesiva o inaccesibilidad a la asistencia médica](https://www.ine.es/jaxi/Tabla.htm?path=/t15/p419/a2017/p02/l0/&file=05004.px&L=0)

- [Inaccesibilidad por dificultades con el transporte](https://www.ine.es/jaxi/Tabla.htm?path=/t15/p420/a2019/p02/l0/&file=05010.px&L=0)

### **DESCRIPCIÓN DEL SET DE DATOS**:
 
Por un lado, los sets de datos que hemos empleado son de tipo *.csv*.

El formato *.csv* ("*Comma Separated Values*") son archivos de texto en los cuales los caracteres están separados por comas, dando lugar a una especie de tabla en forma de filas y columnas. Las columnas quedan definidas por cada punto y coma (;), mientras que cada fila se define mediante una línea adicional en el texto.

Los archivos *.csv* sirven para manejar una gran cantidad de datos en formato tabla, sin que ello conlleve sobrecoste computacional alguno, por eso mismo hemos considerado que es el más eficiente para llevar a cabo la importación de datos.

Pero, antes de nada tenemos que importar el paquete readr, que se trata de una herramienta que permite trabajar con los ficheros de datos.

Por otro lado, el otro tipo de set de datos que hemos utilizado es formato Excel.Es una hoja de cálculo desarrollada por Microsoft, que permite administrar los datos de una manera muy simple. 

Para trabajar con datos de Excel en R debemos usar un paquete desarrollado para tal fin (readxl).

### **RESOLUCIÓN TEMPORAL**:

Últimos 12 meses del año 2020.

### **RESOLUCIÓN ESPACIAL**:

Por comunidades autónomas.


### **POBLACIÓN**:

Personas de 15 o más años, tanto hombres como mujeres, expecto en el data set de defunciones por comunidad autónoma, que entran todos los rangos de edad.


### __HERRAMIENTAS UTILIZADAS__:

### __DATOS__:

### **Inaccesibilidad por motivos económicos (por comunidad autónoma)**:
  
- **Importamos el set de datos del INE sobre la inaccesibilidad sanitaria por motivos ecónomicos agrupados por comunidad autónoma **.

  
   library(readr)
   Inaccesibilidad_por_motivos_economicos <-
   read_delim("DATOS/Inaccesibilidad por motivos economicos.csv", 
   delim = ";", escape_double = FALSE, trim_ws = TRUE)
   View(Inaccesibilidad_por_motivos_economicos)
   
### Analisis de los datos   

- Obtenemos el numero de columnas que tiene:

str(Inaccesibilidad_por_motivos_economicos)
  
- Especificamos de que tipo son:

spec(Inaccesibilidad_por_motivos_economicos)
  
- Obtenemos resumen de los resultados:

  summary(Inaccesibilidad_por_motivos_economicos)

**Relación entre los casos de muerte y la inaccesibilidad (por comunidad autónoma)**: 

    library(tidyverse)

- **Importamos el set de datos del INE de defunciones por comunidad autónoma de residencia.**

Comunidad autónoma de residencia del fallecido / Mes / Sexo / Total

library(readxl)
Muerte_inaccesibilidad <- read_excel("DATOS/Muerte_inaccesibilidad.xlsx")
View(Muerte_inaccesibilidad)

Vista general:

summary(Muerte_inaccesibilidad)
str(Muerte_inaccesibilidad)


Seleccionamos sólo aquellas variables que nos interesan: Total / Comunidad autónoma de residencia

Muerte_inaccesibilidad %>%
  select(`Comunidad autónoma de residencia del fallecido`, Total_muertes = Total)

Importamos el set de datos del INE de demora excesiva o inaccesibilidad a la asistencia médica por lista de espera en los últimos 12 meses según sexo y comunidad autónoma. Población de 15 y más años

# Sexo/ Comunidad autónoma / Sí o no / Total
library(readxl)
inaccesibilidad_comunidades <- read_excel("DATOS/inaccesibilidad_comunidades.xlsx")
View(inaccesibilidad_comunidades)

Vista general:

summary(inaccesibilidad_comunidades)
str(inaccesibilidad_comunidades)

Seleccionamos sólo aquellas variables que nos interesan: Sí o no / Total

inaccesibilidad_comunidades %>%
  select(`Comunidad autónoma`, `Sí o no`, Total)
  
# Realizamos un full join entre ambos sets de datos, utilizando como elemento de unión la comunidad autónoma, y lo guardamos en un objeto llamado "Correlacion_muerte_inaccesibilidad"
Correlacion_muerte_inaccesibilidad <-
Muerte_inaccesibilidad %>% 
  select(`Comunidad autónoma de residencia del fallecido`, Total) %>% 
  full_join(x = ., 
            y = inaccesibilidad_comunidades %>% 
              select(`Comunidad autónoma`, `Sí o no`, Total),
            by = c("Comunidad autónoma de residencia del fallecido" = "Comunidad autónoma"))
          
# Comprobamos las variables del nuevo set de datos creado a partir de los anteriores, y el número de repeticiones que aparece en cada una de ellas:
Correlacion_muerte_inaccesibilidad
table(Correlacion_muerte_inaccesibilidad$`Sí o no`)

# Como en nuestro set de datos, no se especifica cuál es la diferencia entre "No" y "No necesitó asistencia", hemos dado por hecho que "No necesitó asistencia" implica que no hubo inaccesibilidad sanitaria, y por tanto, hemos sumado los datos de ambas variables en una única ("No"):
Resultado_final <- Correlacion_muerte_inaccesibilidad %>% 
  mutate(`Sí o no` = factor(`Sí o no`, labels = c("No", "No", "Sí", "Total"))) %>% 
  filter(`Sí o no` != "Total")
  
x11()

# Finalmente, eliminamos los valores NA, para que no afecten a nuestro resultado final y obtenemos el box-plot que relaciona el número total de muertes y la inaccesibilidad sanitaria por comunidad autónoma:
Resultado_final %>% 
  drop_na() %>% 
  ggplot(data = ., mapping = aes(x = `Sí o no` , y = Total.x)) +
  geom_point(na.rm = TRUE) +
  geom_boxplot(na.rm = TRUE)+
  labs(x = "Sí inaccesibilidad / No inaccesibilidad", y = "Total de muertes", 
       subtitle = "Correlación entre número de muertes e inaccesibilidad sanitaria") +
  theme_classic()
  
  
  -**Inaccesibilidad y dificultades de transporte (por comunidad autónoma)**:
  
Importamos el set de datos:

library(readr)
Inaccesibilidad_y_dificultades_de_transporte <- read_delim("DATOS/Inaccesibilidad y dificultades de transporte.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(Inaccesibilidad_y_dificultades_de_transporte)

# ANÁLISIS DE LOS DATOS:

 - Obtenemos el número de columnas que tiene:
  
  str(Inaccesibilidad_y_dificultades_de_transporte)
  
 - Especificamos de que tipo son:

  spec(Inaccesibilidad_y_dificultades_de_transporte)

 -Obtenemos resumen de los resultados:
 
  summary(Inaccesibilidad_y_dificultades_de_transporte)


# Nuestro set de datos esta compuesto por 4 columnas:

- **Sexo**: compuesto por 300 elementos, clase caracter. Pueden ser hombres, mujeres o ambos sexos.

- **Comunidad autonónoma**: compuesto por 300 elementos, clase caracter. Dividido por el total nacional y las diferentes comunidades autonomas (Andalucia, Aragón, Asturias, Islas Baleares, Canarias, Cantabria, Castilla y León, Castilla la Mancha, Cataluña,Comunitat Valenciana, Extremadura, Galicia, Madrid, Región de Murcia, Comunidad Foral de Navarra, País Vasco, La Rioja, Cueuta, Melilla).

- **Si o No**: compuesto por 300 elementos, clase caracter. Muestra cuantas personas participaron en la encuesta, el total esta divididos en las personas que SI sufrieron  inaccsesibilidad, quienes NO, las personas que no necesitaron asistencia y por último las que no constan.

- **Total**: compuesto por 300 elementos clase caracter. Es el recuento total de cada variable distinta. 

library(tidyverse)

Seleccionamos sólo aquellas variables que nos interesan: Sí o no / Total/ Comunidad autónoma

Inaccesibilidad_transporte <-  
  Inaccesibilidad_y_dificultades_de_transporte %>% 
  select(`Comunidad autónoma`, `Sí o no`, Total)
  
Inaccesibilidad_transporte
  
#**Realizamos los GRÁFICOS**:

#Filtramos las datos que queremos (Si han sufrido inaccesibilidad) y agrupamos las Comunidades autónomas

Datos_filtrados<-
Inaccesibilidad_transporte %>%
  filter(`Comunidad autónoma`!="Total Nacional" & `Sí o no` != "TOTAL" & `Sí o no` != "No" & `Sí o no` != "No necesitó asistencia" & `Sí o no` != "No consta")%>%
group_by(`Comunidad autónoma`)
  
View(Datos_filtrados)

#Hacemos el gráfico de barras

Resultado <-
  drop_na() %>%
  ggplot(data = Datos_filtrados,
       mapping = aes(x `Comunidad autónoma`, y = Total)) +
  geom_bar(stat='identity')+
  labs(title= "Inaccesibilidad transporte", x= "Comunidades autónomas", y= "Total")
  
Resultado


En el gráfico anterior se muestran las personas que han sufrido inaccesibilidad o demora excesiva a la asistencia sanitaria debido al transporte o la distancia.
La comparación que hemos realizado es por comunidades autónomas. Las conclusiones que podemos sacar son las siguientes: la comunidad que más ha sufrido es Andalucía, en cambio, las que menos Cantabria y las ciudades de Ceuta y Melilla.


